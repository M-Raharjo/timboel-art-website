{{ define "main" }}

<main>

  <h1 style="text-align:center; padding:0 2rem;">{{ .Title }}</h1>
  {{ with .Content }}<div>{{ . }}</div>{{ end }}

  <hr>

  {{ if .Sections }}

    <section class="grid">
      {{ range sort .Sections "Weight" "Title" }}
        {{ $thumb := or .Params.featured_image .Params.main_image }}
        {{ if not $thumb }}
          {{ with (first 1 (.Resources.ByType "image")) }}
            {{ $thumb = (index . 0).RelPermalink }}
          {{ end }}
        {{ end }}

        <div>
          <a href="{{ .RelPermalink }}">
            {{ if $thumb }}
              <img src="{{ $thumb }}" alt="{{ .LinkTitle }}" loading="lazy" onerror="this.onerror=null;this.src='{{ .Params.thumbnail }}';">
            {{ end }}
            <div><h3>{{ .LinkTitle }}</h3></div>
            <div>{{ .Summary }}</div>
          </a>
        </div>
      {{ end }}
    </section>

  {{ else if .RegularPages }}
{{ $p := .Paginate (sort .RegularPages "Params.date_added" "Title") 16 }}

<section class="grid">
  {{ range $p.Pages }}
    {{ $thumb := or .Params.featured_image .Params.main_image .Params.thumbnail }}
    {{ if not $thumb }}
      {{ with (first 1 (.Resources.ByType "image")) }}
        {{ $thumb = (index . 0).RelPermalink }}
      {{ end }}
    {{ end }}

    <div>
      <a href="{{ .RelPermalink }}">
        {{ if $thumb }}
          <img
            src="{{ $thumb }}"
            alt="{{ .LinkTitle }}"
            loading="lazy"
            onerror="this.onerror=null;this.src='{{ .Params.thumbnail }}';"
          >
        {{ end }}
        <div><h3>{{ .LinkTitle }}</h3></div>
        <p>{{ .Summary }}</p>
      </a>
    </div>
  {{ end }}
</section>

<nav class="site-nav" style="justify-content: center;">
  {{ with $p.Prev }}<a href="{{ .URL }}">Prev</a>{{ end }}
  <span>{{ $p.PageNumber }} / {{ $p.TotalPages }} </span>
  {{ with $p.Next }}<a href="{{ .URL }}">Next</a>{{ end }}
</nav>

  {{ else }}

    <p>No content found. on default list</p>

  {{ end }}

</main>

{{ end }}
